var tt = "#fEffect/CharacterEff/1082565/0/0#"; //饼干兔子
// 每个阶段礼包所需的充值数
var condition = new Array(50, 100, 300, 500, 1000, 3000, 5000, 8000, 10000);
// 礼包内容
var reward = new Array(
					// 礼包1
					Array(1, 2430893, 1),          // 超级神奇魔方
					Array(1, 5062009, 20),          // 超级神奇魔方
					Array(1, 5062002, 50),        // 征服者币
					Array(1, 5062024, 10),     //闪炫
    				        Array(1, 2340000, 5),      // 祝福卷轴
    				        Array(1, 4001839, 250),      // 星星


					// 礼包2
					Array(2, 1012319, 1),     // 8周年点点红
					Array(2, 2431468, 1),     // 140防具自选
					Array(2, 2431296, 1),     // 140武器自选
					Array(2, 5062009, 30),          // 定居金一百万
					Array(2, 5062002, 50),        // 征服者币
					Array(2, 5062024, 10),     //闪炫
    				        Array(2, 2340000, 5),      // 祝福卷轴
    				        Array(2, 4000313, 1),      // 黄金枫叶
    				        Array(2, 4001839, 500),      // 星星


					// 礼包3
					Array(3, 1003720, 1),            //神奇魔方
					Array(3, 2431468, 1),     // 140
					Array(3, 2434666, 1),          // 定居金一百万
					Array(3, 2590010, 1),          // 定居金一百万
					Array(3, 2591159, 1),          // 定居金一百万
					Array(3, 5062009, 40),          // 定居金一百万
					Array(3, 5062002, 50),        // 征服者币
					Array(3, 5062500, 50),        // 征服者币
					Array(3, 5062024, 10),     //闪炫
					Array(3, 2049402, 3),       //特殊潜能附加卷轴 100%
    				        Array(3, 5064000, 5),          //防暴卷轴
    				        Array(3, 2340000, 5),      // 祝福卷轴
    				        Array(3, 4000313, 1),      // 黄金枫叶
    				        Array(3, 4001839, 1000),      // 星星

					// 礼包4
					Array(4, 1402224, 1),            //柳德之剑
					Array(4, 4310036, 5000),           //征服者币
					Array(4, 4001126, 2000),           //征服者币
					Array(4, 2590010, 1),           //征服者币
					Array(4, 2591159, 1),           //征服者币
					Array(4, 2049750, 5),           //征服者币
					Array(4, 5062009, 50),            //神奇魔方
    				        Array(4, 4000313, 5),      // 黄金枫叶
					Array(4, 5062002, 50),           //高级神奇魔方
					Array(4, 5062024, 10),     //闪炫
    				        Array(4, 5064000, 5),          //防暴卷轴
                                        Array(4, 5062500, 50), //大师附加神奇魔方
                                        Array(4, 5062010, 2), //金光潜能附加印章
					Array(4, 2340000, 10),         //祝福卷轴
					Array(4, 2049402, 5),       //特殊潜能附加卷轴 100%
                                        Array(4, 5390000, 25),  //炽热情景喇叭
                                        Array(4, 5390001, 25),  //绚烂情景喇叭
                                        Array(4, 5390002, 25),  //爱心情景喇叭
                                        Array(4, 2432228, 1),               //名片戒指箱子
    				        Array(4, 4001839, 2000),     // 星星

					// 礼包1003720
					Array(5, 2430885, 1),            //神奇魔方
					Array(5, 2590010, 1),     // 140
					Array(5, 2591391, 1),            //神奇魔方
					Array(5, 5062009, 100),            //神奇魔方
    				        Array(5, 4000313, 3),      // 黄金枫叶
					Array(5, 5062002, 100),           //高级神奇魔方
					Array(5, 5062024, 20),     //闪炫
    				        Array(5, 5064000, 5),          //防暴卷轴
                                        Array(5, 5062500, 50), //大师附加神奇魔方
                                        Array(5, 5062010, 5), //金光潜能附加印章
					Array(5, 2340000, 20),         //祝福卷轴
					Array(5, 2049402, 5),       //特殊潜能附加卷轴 100%
                                        Array(5, 5390000, 30),  //炽热情景喇叭
                                        Array(5, 5390001, 30),  //绚烂情景喇叭
                                        Array(5, 5390002, 30),  //爱心情景喇叭
                                        Array(5, 2432228, 1),               //名片戒指箱子
    				        Array(5, 4001839, 5000),      // 星星
 


					// 礼包6
					Array(6, 1382235, 1),                    //阿丽莎之光辉
					Array(6, 2430885, 1),                    //FFN防具箱
					Array(6, 2433418, 1),                    //暴君防具箱自选
					Array(6, 1113075, 1),                    //最高级贝勒戒指
					Array(6, 1113074, 1),                    //高级贝勒戒指
        		                Array(6, 5064000, 10),                //防暴卷轴
					Array(6, 2340000, 30),               //祝福卷轴
                                        Array(6, 5062500, 100), //大师附加神奇魔方
					Array(6, 5062024, 50),     //闪炫
                                        Array(6, 5062010, 10), //金光潜能附加印章
                                        Array(6, 5062000, 100),             //神奇魔方
                                        Array(6, 5062002, 100),            //高级神奇魔方
                                        Array(6, 2049137, 15),          //惊人正义卷轴
                                        Array(6, 5390000, 100),  //炽热情景喇叭
                                        Array(6, 5390001, 100),  //绚烂情景喇叭
                                        Array(6, 5390002, 100),  //爱心情景喇叭
                                        Array(6, 5390003, 50),                //新年庆祝喇叭1
                                        Array(6, 5390004, 50),                //新年庆祝喇叭2
                                        Array(6, 3010826, 1), //地球椅子
                                        Array(6, 3010824, 1), //水星椅子
                                        Array(6, 3010825, 1), //金星椅子
                                        Array(6, 3010827, 1), //火星椅子
    				        Array(6, 4000313, 5),      // 黄金枫叶
    				        Array(6, 4001839, 10000),      // 星星


					// 礼包7
					Array(7, 1402180, 1),                    //解放的凯瑟利安
					Array(7, 2430885, 1),                    //FFN防具箱
					Array(7, 2433418, 1),                    //暴君防具箱
					Array(7, 1132246, 1),                    //最高级贝勒腰带
        		                Array(7, 5064000, 20),                //防暴卷轴
					Array(7, 2340000, 50),               //祝福卷轴
                                        Array(7, 5062500, 100), //大师附加神奇魔方
                                        Array(7, 5062010, 10), //金光潜能附加印章
					Array(7, 5062024, 100),     //闪炫
					Array(7, 5000352, 1),     //VIP
					Array(7, 5000353, 1),     //VIP
					Array(7, 5000354, 1),     //VIP
					Array(7, 1112140, 1),     //VIP
					Array(7, 1112247, 1),     //VIP
					Array(7, 1112787, 1),     //VIP
					Array(7, 1003698, 1),     //VIP
					Array(7, 3700071, 1),     //VIP
					Array(7, 5390013, 500),     //VIP
                                        Array(7, 5062000, 100),             //神奇魔方
                                        Array(7, 5062002, 100),            //高级神奇魔方
                                        Array(7, 2049765, 5),     //S级潜能卷轴 80%
                                        Array(7, 2049138, 20),          //惊人正义卷轴 
                                        Array(7, 5390000, 100),  //炽热情景喇叭
                                        Array(7, 5390001, 100),  //绚烂情景喇叭
                                        Array(7, 5390002, 100),  //爱心情景喇叭
                                        Array(7, 5390003, 100),                //新年庆祝喇叭1
                                        Array(7, 5390004, 100),                //新年庆祝喇叭2
    				        Array(7, 4000313, 5),      // 黄金枫叶
                                        Array(7, 3010828, 1), //木星椅子
                                        Array(7, 3010829, 1), //土星椅子
                                        Array(7, 3010830, 1), //天王星椅子
                                        Array(7, 3010831, 1), //海王星椅子
                                        Array(7, 3010832, 1), //太阳椅子



    					// 礼包
					Array(8, 2430885, 3),                    //FFN防具箱
					Array(8, 1102724, 1),                    //暴君防具箱
					Array(8, 2430886, 1),                    //160武器自选
					Array(8, 2433418, 1),                    //暴君自选
					Array(8, 1032223, 1),                    //最高级贝勒耳环
					Array(8, 1122267, 1),                    //最高级贝勒项链
                                        Array(8, 5064000, 30),                //防暴卷轴
					Array(8, 2340000, 100),               //祝福卷轴
					Array(8, 5062000, 200),             //神奇魔方
					Array(8, 5062002, 200),            //高级神奇魔方
					Array(8, 5062500, 200),           //大师附加魔方
					Array(8, 5062024, 150),     //闪炫
					Array(8, 1112139, 1),     //VIP
					Array(8, 1112246, 1),     //VIP
					Array(8, 1112786, 1),     //VIP
					Array(8, 1003697, 1),     //VIP
					Array(8, 3700070, 1),     //VIP
					Array(8, 5390012, 500),     //VIP
                                        Array(8, 2049750, 5),     //S级潜能卷轴 80%
    				        Array(8, 4000313, 20),      // 黄金枫叶
					Array(8, 2049155, 30),          //惊人正义卷轴
					Array(8, 2049323, 15),         //高级装备强化卷轴 
					Array(8, 5000257, 1),        //冒险岛航星椅子
					Array(8, 5000256, 1),        //冒险岛航星椅子
					Array(8, 5000258, 1),        //冒险岛航星椅子
					Array(8, 3010876, 1),        //冒险岛航星椅子
					Array(8, 3015193, 1),        //被驯服的鲸鱼椅子
					Array(8, 3015328, 1),        //冒险岛电动缆车椅子
					Array(8, 5390000, 100),  //炽热情景喇叭
					Array(8, 5390001, 100),  //绚烂情景喇叭
					Array(8, 5390002, 100),  //爱心情景喇叭
					Array(8, 5390003, 100),                //新年庆祝喇叭1
					Array(8, 5390004, 100),                //新年庆祝喇叭2
					Array(8, 5390007, 100),//球进了喇叭
					Array(8, 5390005, 100),//小老虎喇叭
					Array(8, 5390010, 100),//鬼出没喇叭


        					// 礼包10
					Array(9, 2433418, 2),                    //暴君防具箱
					Array(9, 1102723, 1),                    //暴君防具箱
					Array(9, 1132246, 1),                    //最高级贝勒德
					Array(9, 1122267, 1),                    //最高级贝勒德
					Array(9, 1032223, 1),                    //最高级贝勒德
					Array(9, 1113075, 1),                    //最高级贝勒德
					Array(9, 5000281, 1),                    //最高级贝勒德
					Array(9, 5000282, 1),                    //最高级贝勒德
					Array(9, 5000283, 1),                    //最高级贝勒德
                                        Array(9, 3010822, 1), //贪吃鳄鱼椅子
                                        Array(9, 3015343, 1), //冰雪企鹅王椅子
                                        Array(9, 5064000, 50),                //防暴卷轴
					Array(9, 2340000, 100),               //祝福卷轴
    				        Array(9, 4000313, 30),      // 黄金枫叶
                                        Array(9, 5062000, 300),             //神奇魔方
                                        Array(9, 5062002, 300),            //高级神奇魔方
                                        Array(9, 5062500, 300),           //大师附加魔方
					Array(9, 5062024, 300),     //闪炫
					Array(9, 1112138, 1),     //VIP
					Array(9, 1112245, 1),     //VIP
					Array(9, 1112785, 1),     //VIP
					Array(9, 1003696, 1),     //VIP
					Array(9, 3700069, 1),     //VIP
					Array(9, 5390011, 500),     //VIP
                                        Array(9, 2049762, 5),     //S级潜能卷轴 80%
                                        Array(9, 2049155, 50),          //惊人正义卷轴
                                        Array(9, 2049323, 30),         //高级装备强化卷轴 
                                        Array(9, 3016000, 1),        //水族馆椅子
                                        Array(9, 3016101, 1),        //怪物水晶球秋千椅
                                        Array(9, 3015182, 1),        //蝶恋花椅子
                                        Array(9, 5390000, 100),  //炽热情景喇叭
                                        Array(9, 5390001, 100),  //绚烂情景喇叭
                                        Array(9, 5390002, 100),  //爱心情景喇叭
                                        Array(9, 5390003, 100),                //新年庆祝喇叭1
                                        Array(9, 5390004, 100),                //新年庆祝喇叭2
                                        Array(9, 5390007, 100),//球进了喇叭
                                        Array(9, 5390013, 100,//小老虎喇叭
                                        Array(9, 5390010, 100)//鬼出没喇叭
                                        ));

var sel;
var status = -1;
var text;
var ljname;
var curlevel = -1;;
function start() {
    action(1, 0, 0);
}

function action(mode, type, selection) {
    if (status == 0 && mode == 0) {
        cm.dispose();
        return;
    }
    if (mode == 1) {
        status++;
    } else {
        status--;
    }

    if (status == 0) {
        var revenue = cm.getHyPay(3);
        text = "\t\t\t" + tt + " #e#r飞跃▲充值礼包中心#k#n " + tt + "\r\n\r\n";
        text += "#d#e当前总充值金额数量： #r" + revenue.formatMoney(0, "") + " #d元#k\r\n#e";
        text += "#d#e累计首充50送140级自选 银河副武器#k\r\n#d#e累计首充100送110级脸饰 8周年点点红#k\r\n#d#e累计首充300送150级法弗纳（自选） 进阶半半头盔#k\r\n#d#e累计首充500送150级段数神器 柳德之剑#k\r\n#d#e累计首充1000送150法弗纳防具（自选） 伟大的皮埃尔灵魂结晶#k\r\n#d#e累计首充3000送法师神器 阿丽莎之光辉（全属性200）#k\r\n#d#e累计首充5000送战士神器 解放的凯瑟利安（全属性200#k\r\n#d#e累计首充8000送神装 法弗纳防具一套 100全属性点装翅膀#k\r\n#d#e累计首充10000送顶级神装 暴君两件 最高级贝勒德首饰一套 200全属性点装翅膀#k\r\n#e";
        for (var i = 1; i <= condition.length; i++) {
            if (cm.getEventCount("累计充值礼包" + i, 1) == 1) {
                text += "#d#L" + i + "#" + tt + " [#r已完成#d]累计充值福利 #r\t\t\t" + condition[i - 1] + "#l\r\n";
                curlevel = curlevel == -1 ? i : curlevel;
            } else {
                text += "#d#L" + i + "#" + tt + " [未完成]累计充值福利 #r\t\t\t" + condition[i - 1] + "#l\r\n";
            }
        }
        text += "#k";
        cm.sendSimple(text);
    } else if (status == 1) {
        sel = selection;
        text = "\t\t\t#e#r- 累计充值" + condition[selection - 1] + "元福利 -#k#n\r\n\r\n";
        for (var i = 0; i < reward.length; i++) {
            if (reward[i][0] == selection) {
                text += "\t\t\t#i" + reward[i][1] + "# #z" + reward[i][1] + "#[" + reward[i][2] + "个]\r\n";
            }
        }
        cm.sendYesNo(text);
    } else if (status == 2) {
        if (cm.getEventCount("累计充值礼包" + sel, 1) == 1) {
            cm.sendOk("#e#r\r\n\r\n\t\t这个礼包您已经领取过了");
            status = -1;
            //cm.dispose();
            return;
        }
        if (cm.getHyPay(3) < condition[sel - 1]) {
            cm.playerMessage(1, "累计金额未达标！");
            cm.dispose();
            return;
        }

        var rewardlist = new Array();
        for (var i = 0; i < reward.length; i++) {
            if (reward[i][0] == sel) {
                if (reward[i][3] == null)
                    reward[i][3] = -1;
                rewardlist.push(new Array(reward[i][1], reward[i][2], reward[i][3]));
            }
        }
        if (!cm.canHoldSlots(rewardlist.length)) {
            cm.sendOk("包裹空间不足，请确保包裹每个栏位有至少 " + rewardlist.length + " 格空间");
            cm.dispose();
            return;
        }
        for (var i = 0; i < rewardlist.length; i++) {
            if (rewardlist[i][0] == 2430865) {
                cm.gainItem(rewardlist[i][0], rewardlist[i][1], rewardlist[i][2]);
            } else {
                cm.gainItem(rewardlist[i][0], rewardlist[i][1]);
            }
        }
        cm.setEventCount("累计充值礼包" + sel, 1);
        cm.playerMessage(1, "领取成功");
        cm.worldSpouseMessage(0x20, "≡累计充值≡　　恭喜玩家 " + cm.getChar().getName() + " 领取了累计充值 " + condition[sel - 1] + " 元的福利礼包！！！");
        cm.dispose();
    }
}

Number.prototype.formatMoney = function (places, symbol, thousand, decimal) {
    places = !isNaN(places = Math.abs(places)) ? places : 2;
    symbol = symbol !== undefined ? symbol : "　";
    thousand = thousand || ",";
    decimal = decimal || ".";
    var number = this,
        negative = number < 0 ? "-" : "",
        i = parseInt(number = Math.abs(+number || 0).toFixed(places), 10) + "",
        j = (j = i.length) > 3 ? j % 3 : 0;
    return symbol + negative + (j ? i.substr(0, j) + thousand : "") + i.substr(j).replace(/(\d{3})(?=\d)/g, "$1" + thousand) + (places ? decimal + Math.abs(number - i).toFixed(places).slice(2) : "");
};